let developers = [
    {
        "id": "b8878c6c-eda2-35ee-f621-91f9b7af14dc",
        "name": "Kiss Lajos",
        "email": "KissLajos@webler.hu",
        "job": "Frontend Developer",
        "age": 35,
        "salary": 350000,
        "image": "https://randomuser.me/api/portraits/men/1.jpg",
        "skills": [
            "User Research",
            "Wireframing",
            "Prototyping",
            "Figma",
            "Sketch",
            "Interaction Design",
            "Visual Design"
        ]
    },
    {
        "id": "a49335ca-d76a-02d1-2a6c-fdab1a3f8c0a",
        "name": "Tony Stark",
        "email": "mrstark@starkindustries.com",
        "job": "Frontend Developer",
        "age": 23,
        "salary": 2500000,
        "image": "https://randomuser.me/api/portraits/men/2.jpg",
        "skills": [
            "JavaScript",
            "React",
            "CSS",
            "HTML",
            "Redux"
        ]
    },
    {
        "id": "d255b2e3-9fde-c833-1cda-fa9ee62e851c",
        "name": "John Doe",
        "email": "JohnDoe@greenwave.hu",
        "job": "Frontend Developer",
        "age": 35,
        "salary": 1556000,
        "image": "https://randomuser.me/api/portraits/men/3.jpg",
        "skills": [
            "HTML",
            "Vue.js",
            "CSS",
            "JavaScript"
        ]
    },
    {
        "id": "20ef4e13-94db-8a96-ca02-4f65a2a545d2",
        "name": "Robert Smith",
        "email": "RobertSmith@greenwave.hu",
        "job": "Fullstack Developer",
        "age": 40,
        "salary": 999000,
        "image": "https://randomuser.me/api/portraits/men/4.jpg",
        "skills": [
            "Node.js",
            "Express",
            "MongoDB",
            "React",
            "RESTful APIs"
        ]
    },
    {
        "id": "e31bc524-918f-a7dc-6b36-0be9c7181a11",
        "name": "James Alexander Mitchell",
        "email": "jam@alphatech.com",
        "job": "Backend Developer",
        "age": 30,
        "salary": 406000,
        "image": "https://randomuser.me/api/portraits/men/5.jpg",
        "skills": [
            "Python",
            "Django",
            "Flask",
            "RESTful APIs"
        ]
    },
    {
        "id": "fbdc476a-eedf-de7e-bac6-2563dd40b0ab",
        "name": "Rose Parker",
        "email": "RoseParker@alphatech.com",
        "job": "Frontend Developer",
        "age": 40,
        "salary": 250000,
        "image": "https://randomuser.me/api/portraits/women/6.jpg",
        "skills": [
            "JavaScript",
            "Angular",
            "HTML",
            "CSS"
        ]
    },
    {
        "id": "575bc89b-907f-3410-0fd2-cc119004b7ed",
        "name": "Sophia Grace",
        "email": "SophiaGrace@alphatech.com",
        "job": "Backend Developer",
        "age": 60,
        "salary": 345000,
        "image": "https://randomuser.me/api/portraits/women/7.jpg",
        "skills": [
            "Java",
            "Spring Boot",
            "SQL"
        ]
    },
    {
        "id": "b83254e1-8893-666a-1185-17cfab8d9a5c",
        "name": "Kovács András",
        "email": "KovacsAndras@alphatech.com",
        "job": "Architect",
        "age": 34,
        "salary": 1500000,
        "image": "https://randomuser.me/api/portraits/men/8.jpg",
        "skills": [
            "Angular",
            "TypeScript"
        ]
    },
    {
        "id": "c9878a6c-7ba3-45ee-f619-91f9a7ef23dc",
        "name": "Egres Kata",
        "email": "EgresKata@starsolutions.net",
        "job": "Data Scientist",
        "age": 28,
        "salary": 520000,
        "image": "https://randomuser.me/api/portraits/women/9.jpg",
        "skills": [
            "Python"
        ]
    },
    {
        "id": "d49337ca-d78a-12e1-3a5d-fdab2b3f9d2a",
        "name": "Nagy Péter",
        "email": "NagyPeter@starsolutions.net",
        "job": "DevOps Engineer",
        "age": 42,
        "salary": 620000,
        "image": "https://randomuser.me/api/portraits/men/10.jpg",
        "skills": [
            "Docker",
            "Kubernetes",
            "CI/CD"
        ]
    },
    {
        "id": "e255a2b3-9fde-d833-1dfa-fa9fe62e85fc",
        "name": "Linda Parker",
        "email": "LindaParker@starsolutions.net",
        "job": "Project Manager",
        "age": 37,
        "salary": 460000,
        "image": "https://randomuser.me/api/portraits/women/11.jpg",
        "skills": [
            "Agile Methodologies",
            "Scrum",
            "JIRA"
        ]
    },
    {
        "id": "f0ef5e14-93db-7c96-da32-4e65b2a655d2",
        "name": "Thomas Evans",
        "email": "ThomasEvans@starsolutions.net",
        "job": "Machine Learning Engineer",
        "age": 31,
        "salary": 730000,
        "image": "https://randomuser.me/api/portraits/men/12.jpg",
        "skills": [
            "Python"
        ]
    },
    {
        "id": "g41bc623-818f-b8dc-5b26-0af8c5184a12",
        "name": "Anna Scott",
        "email": "AnnaScott@starsolutions.net",
        "job": "Security Analyst",
        "age": 29,
        "salary": 395000,
        "image": "https://randomuser.me/api/portraits/women/13.jpg",
        "skills": [
            "Network Security"
        ]
    },
    {
        "id": "h3dc376b-f8df-ce7e-ba76-2574dd30b0ab",
        "name": "Emily White",
        "email": "EmilyWhite@starsolutions.net",
        "job": "Software Tester",
        "age": 34,
        "salary": 410000,
        "image": "https://randomuser.me/api/portraits/women/14.jpg",
        "skills": [
            "Automated Testing",
            "Selenium",
            "Manual Testing"
        ]
    },
    {
        "id": "i28bc12d-5c93-1b56-3d91-754fe2d8a2b1",
        "name": "Márton István",
        "email": "MartonIstvan@techsphere.net",
        "job": "Cloud Solutions Architect",
        "age": 45,
        "salary": 750000,
        "image": "https://randomuser.me/api/portraits/men/15.jpg",
        "skills": [
            "AWS",
            "Azure",
            "GCP"
        ]
    },
    {
        "id": "j7f32f1b-4d7a-8b94-8e41-dc93e76b4c71",
        "name": "Balázs Zoltán",
        "email": "BalazsZoltan@techsphere.net",
        "job": "Data Scientist",
        "age": 39,
        "salary": 680000,
        "image": "https://randomuser.me/api/portraits/men/16.jpg",
        "skills": [
            "SQL",
            "Database Optimization"
        ]
    },
    {
        "id": "k8fc3d2a-6e39-4d9f-9b11-579fbb64b701",
        "name": "Bartos Gábor",
        "email": "BartosGabor@techsphere.net",
        "job": "Security Analyst",
        "age": 33,
        "salary": 400000,
        "image": "https://randomuser.me/api/portraits/men/17.jpg",
        "skills": [
            "Business Analysis",
            "Data Analysis"
        ]
    }
]

//Táblázat kialalkítása
function renderDevelopers() {
    let tableBody = document.getElementById("developerTableBody");
    tableBody.innerHTML = "";

    developers.forEach((dev, index) => {
        let row = document.createElement("tr");
        row.innerHTML = `
            <td><img src="${dev.image}" class="rounded-circle" style="width: 30px; height: 30px;"></td>
            <td>${dev.name}</td>
            <td><a href="mailto:${dev.email}">${dev.email}</a></td>
            <td>${dev.job}</td>
            <td>${dev.age}</td>
            <td>${getSalaryBadge(dev.salary)}</td>
            <td>
                <button onclick="editDeveloper(${index})" class="btn btn-warning btn-sm">EDIT</button>
                <button onclick="deleteDeveloper(${index})" class="btn btn-danger btn-sm">DELETE</button>
            </td>
        `;
        tableBody.appendChild(row);
    });
}

//Fizetés színezése + HUF
function getSalaryBadge(salary) {
    if (salary < 400000) {
        return `<span class="badge bg-danger">${salary} HUF</span>`;
    } else if (salary < 700000) {
        return `<span class="badge bg-warning text-dark">${salary} HUF</span>`;
    } else {
        return `<span class="badge bg-success">${salary} HUF</span>`;
    }
}


//Átlag számítás
function calculateAverage(numbers) 
{
    if (numbers.length === 0) return 0;
    const sum = numbers.reduce((acc, num) => acc + num, 0);
    return (sum / numbers.length).toFixed(2); 
}

//Kor átlag
const averageAge = calculateAverage(developers.map(dev => dev.age));

//Frontendesek fizetése
const frontendSalaries = developers
    .filter(dev => dev.job === "Frontend Developer")
    .map(dev => dev.salary);
;

//Frontendesek Átlag fizetése
const averageSalary = calculateAverage(frontendSalaries);

//Legtöbb Skilles ember
const mostSkilledDeveloper = developers.reduce((maxDev, currentDev) => {
    return (currentDev.skills.length > maxDev.skills.length) ? currentDev : maxDev;
}, developers[0]);

//Cég számlálás
const companyCounts = developers.reduce((acc, dev) => {
    const company = dev.email.split('@')[1];
    acc[company] = (acc[company] || 0) + 1;
    return acc;
}, {});

//Legfiatalabb
const youngestDeveloper = developers.reduce((youngest, current) => {
    return current.age < youngest.age ? current : youngest;
}, developers[0]);


//Legidősebb
const oldestDeveloper = developers.reduce((oldest, current) => {
    return current.age > oldest.age ? current : oldest;
}, developers[0]);

//|Legfiatalabb -legidősebb|
const salaryDifference = Math.abs(youngestDeveloper.salary - oldestDeveloper.salary);

//Legnagyobb cég
const mostEmployeesCompany = Object.entries(companyCounts).reduce((max, current) => {
    return current[1] > max[1] ? current : max;
}, [null, 0]);

// Munkakörönkénti fizetések
const salaryByJob = developers.reduce((acc, dev) => {
    if (!acc[dev.job]) {
        acc[dev.job] = { totalSalary: 0, count: 0 };
    }
    acc[dev.job].totalSalary += dev.salary;
    acc[dev.job].count++;
    return acc;
}, {});

//Átlag fizetés munkakörönként
const averageSalaries = Object.entries(salaryByJob).map(([job, data]) => {
    return `<p>${job}: ${(data.totalSalary / data.count).toFixed(2)} HUF </p>`;
}).join('');



renderDevelopers();

document.getElementById("AverageAge").innerHTML = "Az átlag életkor : " + averageAge + " év";

document.getElementById("AverageSalary").innerHTML = `Frontend fejlesztők átlagfizetése: ${averageSalary} HUF`;

document.getElementById("MostSkills").innerHTML = "A legtöbb készséggel rendelkező fejlesztő: " + mostSkilledDeveloper.name;

document.getElementById("BiggestFirm").innerHTML = "A legtöbb alkalmazottal rendelkező cég: "  + mostEmployeesCompany[0] +': '+  mostEmployeesCompany[1]  + " (fő)";

document.getElementById("YoungestEmployee").innerHTML = 'A legfiatalabb fejlesztő: ' +youngestDeveloper.name + ' fizetése: ' + youngestDeveloper.salary + ' HUF';

document.getElementById("Difference").innerHTML = " A legidősebb és legfiatalabb fejlesztő közötti fizetéskülönbség: " + salaryDifference +  " HUF"

document.getElementById("Averagesalarybyjobs").innerHTML = averageSalaries
    

    function Create ()
    {
        const JSname = document.querySelector('#name').value;
        const JSage = document.querySelector('#age').value;
        const JSimage = document.querySelector('#image').value;
        const JSjob = document.querySelector('#job').value;
        const JSsalary = document.querySelector('#salary').value;
        const JSemail = document.querySelector('#email').value;

        // Új developer objektum létrehozása
        const newDev = {
            name: JSname,
            age: JSage,
            image: JSimage,
            job: JSjob,
            salary: JSsalary,
            email: JSemail
        };

        // Hozzáadás a tömbhöz
        developers.push(newDev);
        
       

        // Táblázat újrarajzolása
        renderDevelopers();

        // Inputmezők ürítése
        document.querySelector('#name').value = "";
        document.querySelector('#age').value = "";
        document.querySelector('#image').value = "";
        document.querySelector('#job').value = "";
        document.querySelector('#salary').value = "";
        document.querySelector('#email').value = "";
    }

    function markCompleted (e) {
        let x = e.target
        x.classList.toggle ('completed')
    }

    function Load ()
    {
        let temp = localStorage.getItem('developers'); 
    if (temp) {
        developers = JSON.parse(temp); 

        renderDevelopers();
   
    }
    }

    function Save ()
    {
        localStorage.setItem('developers', JSON.stringify(developers))
       
    }

    function editDeveloper(index) {
        const dev = developers[index];
    
        // Adatok betöltése az input mezőkbe
        document.querySelector('#name').value = dev.name;
        document.querySelector('#age').value = dev.age;
        document.querySelector('#email').value = dev.email;
        document.querySelector('#job').value = dev.job;
        document.querySelector('#salary').value = dev.salary;
        document.querySelector('#image').value = dev.image;
    
        // Frissítéshez szükséges logika elindítása
        // A gombot frissítésre kell átállítani
        document.querySelector('#updateBtn').style.display = 'inline-block';
        document.querySelector('#updateBtn').setAttribute('onclick', `updateDeveloper(${index})`);
    }


    function updateDeveloper(index) {
        const updatedDev = {
            name: document.querySelector('#name').value,
            age: document.querySelector('#age').value,
            email: document.querySelector('#email').value,
            job: document.querySelector('#job').value,
            salary: document.querySelector('#salary').value,
            image: document.querySelector('#image').value
        };
    
        developers[index] = updatedDev;  // Frissítjük az adatot a tömbben
    
        // Mentés a localStorage-ba
        localStorage.setItem('developers', JSON.stringify(developers));
    
        // Frissítjük a táblázatot
        renderDevelopers();
    
        // Input mezők ürítése és gomb eltüntetése
        document.querySelector('#name').value = '';
        document.querySelector('#age').value = '';
        document.querySelector('#email').value = '';
        document.querySelector('#job').value = '';
        document.querySelector('#salary').value = '';
        document.querySelector('#image').value = '';
        document.querySelector('#updateBtn').style.display = 'none';  // Elrejtjük a mentés gombot
    }

    function deleteDeveloper(index) {
        // Töröljük az adott elemet a tömbből
        developers.splice(index, 1);
    
        // Mentés a localStorage-ba
        localStorage.setItem('developers', JSON.stringify(developers));
    
        // Frissítjük a táblázatot
        renderDevelopers();
    }
